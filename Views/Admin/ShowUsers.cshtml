@model List<Laundry.Models.User>
@{
    int i = 1;
}
<style>
    .search-input {
        padding: 10px 15px;
        width: 250px;
        font-size: 14px;
        border: 1px solid #ccc;
        border-radius: 25px;
        outline: none;
        transition: all 0.3s ease;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    }

        .search-input::placeholder {
            color: #999;
        }

        .search-input:focus {
            border-color: #4CAF50;
            box-shadow: 0 0 8px rgba(76, 175, 80, 0.3);
        }

</style>
<h1>Customers</h1>
<h1 class="mt-4">Users</h1>
<input type="text" placeholder="Search User Here..." id="search" class="search-input" />
<table class="table-bordered table-hovered table-striped table">

    <thead>
        <tr>
            <th>Id</th>
            <th>Name</th>
            <th>Email</th>
            <th>Phone</th>
            <th>Role</th>
            <th>Created At</th>
            <th>Action</th>
        </tr>
    </thead>
    <tbody id="users">
        @foreach (var users in Model)
        {
            <tr>
                <td>@i</td>
                <td>@users.Name</td>
                <td>@users.Email</td>
                <td>@users.Phone</td>
                <td>@users.Role</td>
                <td>@users.CreatedAt</td>
                <td><a asp-controller="Admin" asp-action="UserBookings" asp-route-id="@users.Id" class="btn btn-primary btn-sm">View Bookings</a></td>
            </tr>
            i++;
        }
    </tbody>
</table>

<script>
    $(document).ready(function () {
        $("#search").on("input", function (e) {
            var search = $("#search").val();

            $.ajax({
                url: "/Admin/SearchUser",
                type: "GET",
                data: { search: search },
                success: function (response) {
                    console.log(response);
                    if (response.user != null) {
                        $("#users").empty();
                        $.each(response.user, function (key, value) {
                            const action = `/Admin/UserBookings/${value.id}`;
                            var output =
                                `
                                        <tr>
                                            <td>${value.id}</td>
                                            <td>${value.name}</td>
                                            <td>${value.email}</td>
                                            <td>${value.phone}</td>
                                            <td>${value.role}</td>
                                                <td>${new Date(value.createdAt).toLocaleString()}</td>
                                                <td><a href="${action}" class="btn btn-primary btn-sm">View Bookings</a></td>
                                        </tr>
                                        `
                            $("#users").append(output)
                        });

                    }
                }
            })
        })
    })
</script>

<script>
    @if (TempData["success"] != null)
    {
        <text>toastr.success('@TempData["success"]');</text>
    }
</script>